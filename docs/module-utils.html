<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Module: utils</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Module: utils</h1>

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description">Utility functions</div>
        

        
            















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line297">line 297</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="~checkPointCRS"><span class="type-signature">(inner) </span>checkPointCRS<span class="signature">(coordinates, mapCenterRadius)</span><span class="type-signature"> &rarr; {GeoJson~Feature}</span></h4>
    

    



<div class="description">
    Checks if the input coordinates are in EPSG:4326 or EPSG:2039 and creates a buffer for the ceneter coordinate using the mapCenterRadius in meters.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>coordinates</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last">center coordinates for the buffer in EPSG:4326 or EPSG:2039</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>mapCenterRadius</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Radius for the created buffer, in meters</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line352">line 352</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Result of the <a href="https://turfjs.org/docs/#buffer">Turf.js buffer</a>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">GeoJson~Feature</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getAddressPoint"><span class="type-signature">(inner) </span>getAddressPoint<span class="signature">(k_rechov, ms_bayit)</span><span class="type-signature"> &rarr; {GeoJson}</span></h4>
    

    



<div class="description">
    Get a Geojson Object of the requested address (street code and house number)
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>k_rechov</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Street code from the <a href="https://gisn.tel-aviv.gov.il/arcgis/rest/services/IView2/MapServer/527">addresses layer</a></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ms_bayit</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">House number on the street</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line360">line 360</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">GeoJson</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
        <p class="code-caption"> Get Tashach, 2 </p>
    
    <pre class="prettyprint"><code>utils.getAddressPoint(574,2)// returns {"type":"FeatureCollection",//           "crs":{"type":"name","properties":{"name":"EPSG:4326"}},//           "features":[//                       {"type":"Feature",//                       "id":42241,//                       "geometry":{//                           "type":"Point",//                           "coordinates":[34.7871253,32.0848195]},//                       "properties":{//                           "oid_ktovet":42241,//                           "id_ktovet":119371,//                           "k_rechov":574,//                           "t_rechov":"תש\"ח",//                           "ms_bayit":2,//                           "knisa":" ",//                           "t_bayit_veknisa":"2 ",//                           "t_ktovet_melea":"תש\"ח 2 ",//                           "x":180058.89000000001,//                           "y":665800.43999999994,//                           "ms_gush":6213,//                           "ms_chelka":661,//                           "k_status_hesder":0,//                           "UniqueId":"527-119371",//                           "lon":34.787125000000003,//                           "lat":32.084817999999999,//                           "date_import":"18/08/2022 01:03:04"}}]}</code></pre>



        
            

    

    
    <h4 class="name" id="~getLayer"><span class="type-signature">(inner) </span>getLayer<span class="signature">(id)</span><span class="type-signature"> &rarr; {object}</span></h4>
    

    



<div class="description">
    Get layer object from the current mapJson
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last">ID of the layer as defined in the ArcGIS server service and as defined by the "id" key in the layer object.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line310">line 310</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    A layer object from the map configuration file.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getLayerFeature"><span class="type-signature">(inner) </span>getLayerFeature<span class="signature">(service<span class="signature-attributes">opt</span>, layer_id, feature_id<span class="signature-attributes">opt</span>, where<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {GeoJson}</span></h4>
    

    



<div class="description">
    Extract a single feature from a map/feature server layerReturns a GeoJson of
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>service</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    "https://gisn.tel-aviv.gov.il/arcgis/rest/services/IView2/MapServer/"
                
                </td>
            

            <td class="description last">The service from which to extract features</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>layer_id</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">layer ID in the map/feature service</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>feature_id</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    1
                
                </td>
            

            <td class="description last">The ID of the feature to extract</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>where</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    ""
                
                </td>
            

            <td class="description last">Where clause for the query rest API</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line413">line 413</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">GeoJson</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getLayerOID"><span class="type-signature">(inner) </span>getLayerOID<span class="signature">(layer_id, service<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Get the layer's Object ID field nameArcGIS Server has a designated field type of ObjectID (defined as "esriFieldTypeOID")The field name can vary since it can be altered, so in order to extract features by ID, the field name is needed.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>layer_id</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">layer ID in the map/feature service</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>service</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    "https://gisn.tel-aviv.gov.il/arcgis/rest/services/IView2/MapServer"
                
                </td>
            

            <td class="description last">The Service from which to extract the layer fields</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line403">line 403</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    The field name of the layer's Object ID
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getLayerUrl"><span class="type-signature">(inner) </span>getLayerUrl<span class="signature">(layer)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    get URL for retreiving a GeoJson contained by a buffer of the neighborhood
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>layer</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An object of <a href="global.html#mapJson-layer">mapJson-layer</a> type</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line317">line 317</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    A URL for the subset of the layer features required by the defined extent/polyogn
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getParamsFromUrl"><span class="type-signature">(inner) </span>getParamsFromUrl<span class="signature">(url)</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    Parses url query string parameters and returns an object of key:value pairs
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">the current location, extracted using decodeURI(location), needed for parameters</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line345">line 345</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    QS an object containing all url parameters after "?" as key:value pairs.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getStreetLine"><span class="type-signature">(inner) </span>getStreetLine<span class="signature">(k_rechov)</span><span class="type-signature"> &rarr; {GeoJson}</span></h4>
    

    



<div class="description">
    Get a Geojson Object of the requested street's extent, with a buffer of 75 meters
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>k_rechov</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Street code from the <a href="https://gisn.tel-aviv.gov.il/arcgis/rest/services/IView2/MapServer/527">addresses layer</a></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line396">line 396</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">GeoJson</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~getUniqueName"><span class="type-signature">(inner) </span>getUniqueName<span class="signature">(n)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Generate unique ID
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>n</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last">length of the unique ID, by default n=8.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line302">line 302</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    A unique combination of only letters and numbers to be used as an ID.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~parseOpacity"><span class="type-signature">(inner) </span>parseOpacity<span class="signature">(inputOpacity)</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    Convert 8bit value to normalized opacity (0-255 -> 0.0-1.0)
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>inputOpacity</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last">Value between 0 and 255</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line324">line 324</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    A normalized value between 0 and 1
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~updateCurrentBounds"><span class="type-signature">(inner) </span>updateCurrentBounds<span class="signature">(map)</span><span class="type-signature"> &rarr; {GeoJson~Feature}</span></h4>
    

    



<div class="description">
    Returns current map bounds as a GeoJson polygon feature
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>map</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">A <a href="https://maplibre.org/maplibre-gl-js-docs/api/map/">MapLibre map</a> object</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line331">line 331</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - A GeoJson <a href="https://tools.ietf.org/html/rfc7946#section-3.2">Feature</a><a href="https://tools.ietf.org/html/rfc7946#section-3.1.6"><Polygon></a>, Result of <a href="https://turfjs.org/docs/#bboxPolygon">Turf.js bboxPolygon</a>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">GeoJson~Feature</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~updateSource"><span class="type-signature">(inner) </span>updateSource<span class="signature">(layer, data)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Replaces the data currently used data for the layer's source
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>layer</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#mapJson-layer">mapJson-layer</a></span>


            
            </td>

            

            

            <td class="description last">An object of <a href="global.html#mapJson-layer">mapJson-layer</a> type</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>data</code></td>
            

            <td class="type">
            
                
<span class="param-type">GeoJson</span>


            
            </td>

            

            

            <td class="description last">A GeoJson Object</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="desktop2_utils.js.html">desktop2_utils.js</a>, <a href="desktop2_utils.js.html#line338">line 338</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-esriRenderer.html">esriRenderer</a></li><li><a href="module-table_utils.html">table_utils</a></li><li><a href="module-utils.html">utils</a></li></ul><h3>Classes</h3><ul><li><a href="FillerControl.html">FillerControl</a></li><li><a href="LayerTable.html">LayerTable</a></li><li><a href="MapHeader.html">MapHeader</a></li><li><a href="MapLegend.html">MapLegend</a></li><li><a href="MapLegendButton.html">MapLegendButton</a></li><li><a href="MapTableButton.html">MapTableButton</a></li></ul><h3>Global</h3><ul><li><a href="global.html#mapJson">mapJson</a></li><li><a href="global.html#mapJson-button">mapJson-button</a></li><li><a href="global.html#mapJson-layer">mapJson-layer</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Mon Aug 22 2022 13:38:35 GMT+0300 (Israel Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>